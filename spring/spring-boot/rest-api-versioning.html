<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="geekmonks, geek, tech, geekmonks tech, free tutorial, free online tutorial"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Geekmonks Tech"><meta name="mobile-web-app-capable" content="yes"><link type="application/atom+xml" rel="alternate" href="https://srvivek1.github.io/geekmonks/feed.xml" title="Geekmonks Tech"/><title>üöÄ Microservice - API Versioning Strategies | Geekmonks Tech</title><meta name="generator" content="Jekyll v3.10.0"/><meta property="og:title" content="üöÄ Microservice - API Versioning Strategies"/><meta property="og:locale" content="en_US"/><meta name="description" content="Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, http headers, path variables, content negotiation, swagger, API documentation, openapi, api versioning, api retirement etc. for beginners and professionals."/><meta property="og:description" content="Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, http headers, path variables, content negotiation, swagger, API documentation, openapi, api versioning, api retirement etc. for beginners and professionals."/><link rel="canonical" href="https://srvivek1.github.io/geekmonks/spring/spring-boot/rest-api-versioning.html"/><meta property="og:url" content="https://srvivek1.github.io/geekmonks/spring/spring-boot/rest-api-versioning.html"/><meta property="og:site_name" content="Geekmonks Tech"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2024-11-09T15:00:00+05:30"/><meta name="twitter:card" content="summary"/><meta property="twitter:title" content="üöÄ Microservice - API Versioning Strategies"/><meta name="twitter:site" content="@srvivek_"/><script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-11-09T15:00:00+05:30","datePublished":"2024-11-09T15:00:00+05:30","description":"Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, http headers, path variables, content negotiation, swagger, API documentation, openapi, api versioning, api retirement etc. for beginners and professionals.","headline":"üöÄ Microservice - API Versioning Strategies","mainEntityOfPage":{"@type":"WebPage","@id":"https://srvivek1.github.io/geekmonks/spring/spring-boot/rest-api-versioning.html"},"url":"https://srvivek1.github.io/geekmonks/spring/spring-boot/rest-api-versioning.html"}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-48XEHMVSEC"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date);gtag("config","G-48XEHMVSEC");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"><link rel="stylesheet" href="/geekmonks/assets/css/styles.css?v=0.1.0"></head><body class="container-fluid p-0 m-0"><header><nav class="navbar navbar-expand-md navbar-light bg-light text-white content-shadow"><div class="container d-flex justify-content-between"><a href="/geekmonks/" class="navbar-brand d-flex"><img class="d-inline-block align-top" src="/geekmonks/assets/icons/laptop.svg" height="40" width="34" alt="banner-1 laptop icon"/><h1 class="fs-3 px-2 fw-bold">Geekmonks</h1><img class="d-inline-block align-top" src="/geekmonks/assets/icons/tux.svg" height="40" width="34" alt="banner-2 penguine icon"/></a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavBanner" aria-controls="navbarNavBanner" aria-expanded="false" aria-label="Toggle Navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarNavBanner" class="collapse navbar-collapse"><ul class="navbar-nav ms-auto"><li class="nav-item active"><a href="/geekmonks/" class="nav-link fw-bold active">Home</a></li><li class="nav-item active"><a href="/geekmonks/about" class="nav-link fw-bold active">About</a></li><li class="nav-item active"><a href="https://github.com/SRVivek1/" class="nav-link fw-bold active" target="_blank" rel="noopener noreferrer">Github</a></li><li class="nav-item active"><a href="https://www.linkedin.com/in/srvivek1/" class="nav-link fw-bold active" target="_blank" rel="noopener noreferrer">LinkedIn</a></li></ul></div></div></nav><nav class="navbar navbar-expand-xl navbar-custom p-0"><div class="container-fluid"><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav mx-auto"><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/ai-ml/llm-engineering/">AI-ML</a></li><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/cloud/aws/">AWS</a></li><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/spring/spring-boot/">Spring Boot</a></li></ul></div></div></nav></header><div class="container-fluid"><div class="row min-vh-100"><nav id="course-sidebar" class="col-md-3 col-lg-2 d-md-block sidebar collapse"><div class="position-sticky pt-3"><ul class="nav flex-column course-topics-list"><a class="nav-link course-link active" href="/geekmonks/spring/spring-boot" data-course="spring/spring-boot"> Spring Boot </a><ul class="nav flex-column ms-2 subtopics" id="topics-spring-spring-boot"><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="getting-started.html" data-topic="getting-started.html" data-course-path="/spring/spring-boot"> Getting Started </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="rest-api-validation.html" data-topic="rest-api-validation.html" data-course-path="/spring/spring-boot"> API Validation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="swagger-api-doc.html" data-topic="swagger-api-doc.html" data-course-path="/spring/spring-boot"> API Documentation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="content-negotiation.html" data-topic="content-negotiation.html" data-course-path="/spring/spring-boot"> Content Negotiation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="i18n.html" data-topic="i18n.html" data-course-path="/spring/spring-boot"> Internationalization (i18n) </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small active" href="rest-api-versioning.html" data-topic="rest-api-versioning.html" data-course-path="/spring/spring-boot"> API Versioning </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="rest-api-retirement.html" data-topic="rest-api-retirement.html" data-course-path="/spring/spring-boot"> API Retirement Strategy </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="hateoas.html" data-topic="hateoas.html" data-course-path="/spring/spring-boot"> HATEOAS </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="static-content-filtering.html" data-topic="static-content-filtering.html" data-course-path="/spring/spring-boot"> Static Content Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="dynamic-content-filtering.html" data-topic="dynamic-content-filtering.html" data-course-path="/spring/spring-boot"> Dynamic Content Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="client-driven-filtering.html" data-topic="client-driven-filtering.html" data-course-path="/spring/spring-boot"> Client-Driven Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="exception-error-handling.html" data-topic="exception-error-handling.html" data-course-path="/spring/spring-boot"> Controller Error Handling </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="hal-explorer.html" data-topic="hal-explorer.html" data-course-path="/spring/spring-boot"> HAL Explorer </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="spring-data-jpa.html" data-topic="spring-data-jpa.html" data-course-path="/spring/spring-boot"> Spring Data JPA </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-with-h2-db.html" data-topic="jpa-with-h2-db.html" data-course-path="/spring/spring-boot"> JPA with H2 DB </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-with-mysql-db.html" data-topic="jpa-with-mysql-db.html" data-course-path="/spring/spring-boot"> JPA with MySQL DB </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-jdbc-template.html" data-topic="jpa-jdbc-template.html" data-course-path="/spring/spring-boot"> JPA & JDBC Teamplate </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="spring-security-basics.html" data-topic="spring-security-basics.html" data-course-path="/spring/spring-boot"> Spring Security </a></li></ul></ul></div></nav><main class="col-md-9 ms-sm-auto col-lg-10 px-md-4"><button id="sidebarToggle" class="btn btn-sm btn-outline-secondary d-md-none mb-2" aria-label="Toggle topics" aria-controls="course-sidebar"> ‚ò∞ Topics </button><div id="topic-content"><div id="pageTitle"><h1>üöÄ Microservice - API Versioning Strategies</h1><p style="font-style: italic;"> Updated on: 09 Nov 2024 - <a href="/geekmonks/authors/srvivek/">Vivek Singh</a></p><hr class="stylish-hr"/></div><h2 id="-table-of-contents">üß≠ Table of Contents</h2><ul><li><a href="#-table-of-contents">üß≠ Table of Contents</a></li><li><a href="#-overview-of-api-versioning">üöÄ Overview of API Versioning</a></li><li><a href="#-common-java-beans-code">üíª Common Java Beans Code</a><ul><li><a href="#personv1java-bean">PersonV1.java bean</a></li><li><a href="#personv2java-bean">PersonV2.java bean</a></li><li><a href="#namejava-bean">Name.java bean</a></li></ul></li><li><a href="#1--uri-versioning">1. üîó URI Versioning</a><ul><li><a href="#key-points">Key Points</a></li><li><a href="#controller-code-changes-java">Controller Code changes (Java)</a></li><li><a href="#test-api-using-curl-command">Test API using CURL command</a></li></ul></li><li><a href="#2--request-parameter-versioning">2. ‚ùì Request Parameter Versioning</a><ul><li><a href="#key-points-1">Key Points</a></li><li><a href="#controller-code-changes-java-1">Controller Code changes (Java)</a></li><li><a href="#test-api-using-curl-command-1">Test API using CURL Command</a></li></ul></li><li><a href="#-custom-header-versioning">üìß Custom Header Versioning</a><ul><li><a href="#key-points-2">Key Points</a></li><li><a href="#controller-code-changes-java-2">Controller Code changes (Java)</a></li><li><a href="#test-api-using-curl-command-2">Test API using CURL command</a></li></ul></li><li><a href="#4--content-negotiation-media-type-versioning">4. üé® Content Negotiation (Media Type) Versioning</a><ul><li><a href="#key-points-3">Key Points</a></li><li><a href="#controller-code-changes-java-3">Controller Code changes (Java)</a></li><li><a href="#test-api-using-curl-command-3">Test API using CURL Command</a></li></ul></li><li><a href="#-comparative-analysis-and-selection">üìä Comparative Analysis and Selection</a><ul><li><a href="#strategy-to-choose-api-versioning-approach">Strategy to Choose API Versioning Approach</a></li></ul></li><li><a href="#-api-gateway-for-centralized-versioning-and-transformation">üåê API Gateway for Centralized Versioning and Transformation</a><ul><li><a href="#gateways-role-in-centralizing-versioning">Gateway‚Äôs Role in Centralizing Versioning</a></li><li><a href="#role-in-transformation-non-breaking-change-scenario">Role in Transformation (Non-Breaking Change Scenario)</a></li></ul></li><li><a href="#next-steps-and-improvements">üí°Next Steps and Improvements</a></li></ul><hr/><h2 id="-overview-of-api-versioning">üöÄ Overview of API Versioning</h2><p>API versioning is a crucial strategy for managing changes to an API over time without disrupting existing clients. It‚Äôs necessary when introducing <strong>breaking changes</strong> (e.g., changing request/response formats, removing fields). A good versioning strategy ensures clients can <strong>conveniently upgrade</strong> to the latest version while clearly communicating changes.</p><blockquote><p><strong>Note</strong></p><ul><li><strong>Maven Dependency:</strong> No external dependency is required for implementing these HTTP architectural style versioning strategies in Spring Boot, as they utilize standard Spring Web annotations.</li></ul></blockquote><hr/><h2 id="-common-java-beans-code">üíª Common Java Beans Code</h2><p>We use two versions of the <code class="language-plaintext highlighter-rouge">Person</code> class to demonstrate a breaking change in the data structure, where <code class="language-plaintext highlighter-rouge">PersonV2</code> nests the name.</p><h3 id="personv1java-bean">PersonV1.java bean</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonV1</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PersonV1</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// getter-setters omitted for brevity</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="personv2java-bean">PersonV2.java bean</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonV2</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Name</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PersonV2</span><span class="o">(</span><span class="nc">Name</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// getter-setters omitted for brevity</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="namejava-bean">Name.java bean</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Name</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Name</span><span class="o">(</span><span class="nc">String</span> <span class="n">firstName</span><span class="o">,</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// getters-setters omitted for brevity</span>
<span class="o">}</span>
</code></pre></div></div><hr/><h2 id="1--uri-versioning">1. üîó URI Versioning</h2><p>In this method, the API version number is embedded directly in the URL path. It‚Äôs the most straightforward and common approach.</p><blockquote><p><strong>Enterprise Example:</strong></p><blockquote><p><strong>Twitter/X</strong> is a well-known example that uses URL versioning strategy (<code class="language-plaintext highlighter-rouge">/v1</code>, <code class="language-plaintext highlighter-rouge">/v2</code>, etc.).</p></blockquote></blockquote><p><br/></p><h3 id="key-points">Key Points</h3><table><thead><tr><th style="text-align: left"><strong>Advantage:</strong></th><th style="text-align: left"><strong>Drawback:</strong></th><th style="text-align: left"><strong>Best Practice:</strong></th></tr></thead><tbody><tr><td style="text-align: left"><strong>Cache-friendly</strong> (versions are distinct URLs), very easy to understand and implement.</td><td style="text-align: left"><strong>Polluting the URL</strong> and requires code changes (new controller classes/methods) for every new version, leading to potential code duplication.</td><td style="text-align: left">Use it for <strong>major, breaking changes</strong>. Align with <strong>Semantic Versioning</strong> (e.g., <code class="language-plaintext highlighter-rouge">/v1</code>, <code class="language-plaintext highlighter-rouge">/v2</code>).</td></tr></tbody></table><p><br/></p><h3 id="controller-code-changes-java">Controller Code changes (Java)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UriVersioningPersonController</span> <span class="o">{</span>

    <span class="cm">/**
    * Version 1: GET /v1/person
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/v1/person"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV1</span> <span class="nf">getPersonV1</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV1</span><span class="o">(</span><span class="s">"URI Versioning v1"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
    * Version 2: GET /v2/person
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/v2/person"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV2</span> <span class="nf">getPersonV2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV2</span><span class="o">(</span><span class="k">new</span> <span class="nc">Name</span><span class="o">(</span><span class="s">"URI"</span><span class="o">,</span> <span class="s">"Versioning V2"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p><br/></p><h3 id="test-api-using-curl-command">Test API using CURL command</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version 1</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/v1/person"</span>

<span class="c"># Version 2</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/v2/person"</span>
</code></pre></div></div><hr/><h2 id="2--request-parameter-versioning">2. ‚ùì Request Parameter Versioning</h2><p>In this approach the API version is passed as a query parameter in the URL. The base URL remains constant across versions.</p><blockquote><p><strong>Enterprise Example:</strong></p><blockquote><p><strong>Amazon</strong> is often cited as using this strategy for some of its services.</p></blockquote></blockquote><p><br/></p><h3 id="key-points-1">Key Points</h3><table><thead><tr><th style="text-align: left"><strong>Advantage:</strong></th><th style="text-align: left"><strong>Drawback:</strong></th><th style="text-align: left"><strong>Best Practice:</strong></th></tr></thead><tbody><tr><td style="text-align: left"><strong>Clean URI</strong> (base path is constant), easy to implement and test.</td><td style="text-align: left"><strong>Polluting the URL</strong> with query parameters, less aesthetically pleasing, and not always considered <strong>RESTful</strong> as the version is not part of the resource identifier.</td><td style="text-align: left"><strong>Best Practice:</strong> Useful when the client is a browser or when <strong>URI cleanliness is a priority</strong>, but less suitable for public-facing APIs.</td></tr></tbody></table><p><br/></p><h3 id="controller-code-changes-java-1">Controller Code changes (Java)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RequestParamVersioningController</span> <span class="o">{</span>

    <span class="cm">/**
    * Version 1: GET /person/param?version=1
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/param"</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">"version=1"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV1</span> <span class="nf">getPersonV1</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV1</span><span class="o">(</span><span class="s">"Request Param versioning v1"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
    * Version 2: GET /person/param?version=2
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/param"</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">"version=2"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV2</span> <span class="nf">getPersonV2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV2</span><span class="o">(</span><span class="k">new</span> <span class="nc">Name</span><span class="o">(</span><span class="s">"Request Parama"</span><span class="o">,</span> <span class="s">"Versioning v2"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="test-api-using-curl-command-1">Test API using CURL Command</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version 1</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/param?version=1"</span>

<span class="c"># Version 2</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/param?version=2"</span>
</code></pre></div></div><hr/><h2 id="-custom-header-versioning">üìß Custom Header Versioning</h2><p>In this strategy the version information is conveyed via a <strong>custom HTTP header</strong>, avoiding changes to the URI.</p><blockquote><p><strong>Enterprise Example:</strong></p><blockquote><p><strong>Microsoft</strong> (Azure APIs) has used custom headers for versioning.</p></blockquote></blockquote><p><br/></p><h3 id="key-points-2">Key Points</h3><table><thead><tr><th style="text-align: left"><strong>Advantage:</strong></th><th style="text-align: left"><strong>Drawback:</strong></th><th style="text-align: left"><strong>Best Practice:</strong></th></tr></thead><tbody><tr><td style="text-align: left"><strong>Clean URLs</strong> (most RESTful in terms of URI), and versions are invisible to generic API consumers unless they inspect the headers.</td><td style="text-align: left"><strong>Drawback:</strong><strong>Misuse of HTTP Headers</strong> (version is not standard HTTP concern), harder to test directly in a browser, and may require extra configuration for <strong>caching layers</strong>.</td><td style="text-align: left"><strong>Best Practice:</strong> Use a clear header name like <code class="language-plaintext highlighter-rouge">X-API-VERSION</code> or <code class="language-plaintext highlighter-rouge">Api-Version</code>. Ensure all client libraries handle custom headers easily.</td></tr></tbody></table><p><br/></p><h3 id="controller-code-changes-java-2">Controller Code changes (Java)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomHeaderVersioning</span> <span class="o">{</span>

    <span class="cm">/**
    * Version 1: GET /person/header with header X-API-VERSION=1
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/header"</span><span class="o">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s">"X-API-VERSION=1"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV1</span> <span class="nf">getPersonV1</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV1</span><span class="o">(</span><span class="s">"Custom Header Versioning v1"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
    * Version 2: GET /person/header with header X-API-VERSION=2
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/header"</span><span class="o">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s">"X-API-VERSION=2"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV2</span> <span class="nf">getPersonV2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV2</span><span class="o">(</span><span class="k">new</span> <span class="nc">Name</span><span class="o">(</span><span class="s">"Custom Header"</span><span class="o">,</span> <span class="s">"Versioning v2"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="test-api-using-curl-command-2">Test API using CURL command</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version 1</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/header"</span> <span class="nt">-H</span> <span class="s2">"X-API-VERSION: 1"</span>

<span class="c"># Version 2</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/header"</span> <span class="nt">-H</span> <span class="s2">"X-API-VERSION: 2"</span>
</code></pre></div></div><hr/><h2 id="4--content-negotiation-media-type-versioning">4. üé® Content Negotiation (Media Type) Versioning</h2><p>Also known as <strong>Accept Header Versioning</strong>. The version is specified within the <strong><code class="language-plaintext highlighter-rouge">Accept</code> HTTP header</strong> using a custom media type (e.g., <code class="language-plaintext highlighter-rouge">application/vnd.comp.app-v1+json</code>).</p><blockquote><p><strong>Enterprise Example:</strong></p><blockquote><p><strong>GitHub</strong> is a prominent example utilizing this strategy.</p></blockquote></blockquote><p><br/></p><h3 id="key-points-3">Key Points</h3><table><thead><tr><th style="text-align: left"><strong>Advantage:</strong></th><th style="text-align: left"><strong>Drawback:</strong></th><th style="text-align: left"><strong>Best Practice:</strong></th></tr></thead><tbody><tr><td style="text-align: left"><strong>Most RESTful</strong> approach according to some purists, as it uses standard HTTP negotiation mechanisms. Clean URLs.</td><td style="text-align: left"><strong>Drawback:</strong><strong>Complex to implement</strong> and can be confusing for developers. Misuse of headers, similar to custom header approach.</td><td style="text-align: left"><strong>Best Practice:</strong> Follow the standard format: <code class="language-plaintext highlighter-rouge">application/vnd.&lt;vendor&gt;.&lt;resource&gt;-v&lt;version&gt;+json/xml</code>. Use it when <strong>resource representation</strong> changes fundamentally.</td></tr></tbody></table><p><br/></p><h3 id="controller-code-changes-java-3">Controller Code changes (Java)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MediaTypeVersioning</span> <span class="o">{</span>

    <span class="cm">/**
    * Version 1: GET /person/accept with Accept: application/vnd.comp.app-v1+json
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/accept"</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/vnd.comp.app-v1+json"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV1</span> <span class="nf">getPersonV1</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV1</span><span class="o">(</span><span class="s">"Mediatype Versioning v1."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
    * Version 2: GET /person/accept with Accept: application/vnd.comp.app-v2+json
    */</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/person/accept"</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/vnd.comp.app-v2+json"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">PersonV2</span> <span class="nf">getPersonV2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">PersonV2</span><span class="o">(</span><span class="k">new</span> <span class="nc">Name</span><span class="o">(</span><span class="s">"Media type"</span><span class="o">,</span> <span class="s">"Versioning v2"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="test-api-using-curl-command-3">Test API using CURL Command</h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version 1</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/accept"</span> <span class="nt">-H</span> <span class="s2">"Accept: application/vnd.comp.app-v1+json"</span>

<span class="c"># Version 2</span>
curl <span class="nt">-X</span> GET <span class="s2">"http://localhost:8080/person/accept"</span> <span class="nt">-H</span> <span class="s2">"Accept: application/vnd.comp.app-v2+json"</span>
</code></pre></div></div><hr/><h2 id="-comparative-analysis-and-selection">üìä Comparative Analysis and Selection</h2><p>Choosing the right approach depends on your API‚Äôs <strong>audience, update frequency, and caching needs</strong>.</p><table><thead><tr><th style="text-align: left">Strategy</th><th style="text-align: left">Advantages</th><th style="text-align: left">Drawbacks</th><th style="text-align: left">Best For</th></tr></thead><tbody><tr><td style="text-align: left"><strong>URI</strong></td><td style="text-align: left">Highly visible, cache-friendly, simple.</td><td style="text-align: left">Pollutes URL, high maintenance (code duplication).</td><td style="text-align: left">Public APIs, major breaking changes.</td></tr><tr><td style="text-align: left"><strong>Request Param</strong></td><td style="text-align: left">Clean URI base, simple to implement.</td><td style="text-align: left">Pollutes URL (query string), less RESTful, not cache-friendly by default.</td><td style="text-align: left">Internal APIs, simple versioning needs.</td></tr><tr><td style="text-align: left"><strong>Custom Header</strong></td><td style="text-align: left">Clean URLs, version is out of the URI.</td><td style="text-align: left">Not browser-testable, potential misuse of headers, complex caching.</td><td style="text-align: left">APIs with frequent, minor updates.</td></tr><tr><td style="text-align: left"><strong>Media Type</strong></td><td style="text-align: left">Most RESTful, clean URLs, resource-level versioning.</td><td style="text-align: left">Most complex to implement, developer confusion, complex caching.</td><td style="text-align: left">APIs with strong REST adherence, internal services.</td></tr></tbody></table><p><br/></p><h3 id="strategy-to-choose-api-versioning-approach">Strategy to Choose API Versioning Approach</h3><p>The choice of API versioning strategy should be made early in the design phase and should be based on your API‚Äôs <strong>audience</strong>, <strong>caching needs</strong>, and the <strong>frequency/complexity</strong> of anticipated changes.</p><table><thead><tr><th style="text-align: left"><strong>Versioning Strategy</strong></th><th style="text-align: left"><strong>Primary Audience</strong></th><th style="text-align: left"><strong>REST Purity</strong></th><th style="text-align: left"><strong>Caching</strong></th><th style="text-align: left"><strong>Implementation Complexity</strong></th><th style="text-align: left"><strong>URL Cleanliness</strong></th></tr></thead><tbody><tr><td style="text-align: left">üîó URI</td><td style="text-align: left"><strong>Public/External</strong></td><td style="text-align: left">Low (Pollutes URL)</td><td style="text-align: left"><strong>High</strong> (Natively Cacheable)</td><td style="text-align: left">Low (Simple <code class="language-plaintext highlighter-rouge">@GetMapping</code>)</td><td style="text-align: left">Low (Version in URL)</td></tr><tr><td style="text-align: left">Query Parameter</td><td style="text-align: left">Internal/Simple APIs</td><td style="text-align: left">Low (Uses Query Params)</td><td style="text-align: left">Low (Requires Custom Config)</td><td style="text-align: left">Low (Simple <code class="language-plaintext highlighter-rouge">params</code> attr)</td><td style="text-align: left">Medium (Base URL clean)</td></tr><tr><td style="text-align: left">üìß Custom Header</td><td style="text-align: left">Partner/Internal</td><td style="text-align: left">Medium (Custom Header)</td><td style="text-align: left">Medium (Requires Header-Aware Config)</td><td style="text-align: left">Medium (Uses <code class="language-plaintext highlighter-rouge">headers</code> attr)</td><td style="text-align: left"><strong>High</strong> (Cleanest URL)</td></tr><tr><td style="text-align: left">üé® Media Type</td><td style="text-align: left"><strong>Strong REST Adherence</strong></td><td style="text-align: left"><strong>High</strong> (Standard HTTP Negotiation)</td><td style="text-align: left">Medium (Requires Content-Aware Config)</td><td style="text-align: left">High (Custom Media Type String)</td><td style="text-align: left"><strong>High</strong> (Cleanest URL)</td></tr></tbody></table><hr/><h2 id="-api-gateway-for-centralized-versioning-and-transformation">üåê API Gateway for Centralized Versioning and Transformation</h2><p>An <strong>API Gateway</strong> acts as a single entry point for all client requests, centralizing cross-cutting concerns like <code class="language-plaintext highlighter-rouge">security</code>, <code class="language-plaintext highlighter-rouge">rate limiting</code>, and <code class="language-plaintext highlighter-rouge">crucially</code>, <strong>API Versioning</strong>.</p><h3 id="gateways-role-in-centralizing-versioning">Gateway‚Äôs Role in Centralizing Versioning</h3><ul><li><strong>Centralized Routing:</strong> The gateway inspects the incoming request (URI path, query param, or header) and routes it to the <strong>correct microservice version</strong>. This shields the client from knowing the internal microservice deployment topology.</li><li><strong>Decoupling:</strong> It decouples the <strong>external API contract</strong> (the version clients see) from the <strong>internal microservice implementation version</strong>.</li></ul><h3 id="role-in-transformation-non-breaking-change-scenario">Role in Transformation (Non-Breaking Change Scenario)</h3><p>For a <strong>non-breaking change</strong> (e.g., adding an optional field in V2, like splitting <code class="language-plaintext highlighter-rouge">name</code> into <code class="language-plaintext highlighter-rouge">firstName</code> and <code class="language-plaintext highlighter-rouge">lastName</code>), the Gateway can simplify client migration:</p><ol><li><strong>V2 Request to V1 Microservice:</strong> * If a V2 client sends a request that is backward compatible with V1, the Gateway can <strong>add default values</strong> for the new V2 fields in the request body before routing it to the V1 service.</li><li><strong>V1 Response Transformation:</strong> * If a V1 client calls the endpoint, the Gateway routes the request to the new V2 microservice. The V2 service responds with the new, richer V2 data structure (<code class="language-plaintext highlighter-rouge">firstName</code>, <code class="language-plaintext highlighter-rouge">lastName</code>). The Gateway then performs a <strong>response transformation</strong> (e.g., concatenating <code class="language-plaintext highlighter-rouge">firstName</code> and <code class="language-plaintext highlighter-rouge">lastName</code> back into a single <code class="language-plaintext highlighter-rouge">name</code> field) to match the expected V1 schema before sending it back to the V1 client.</li></ol><p><br/></p><p>This <strong>transformation capability</strong> allows the backend microservice to <strong>evolve faster</strong> (implementing V2) while the Gateway maintains <strong>backward compatibility</strong> for older V1 clients without requiring a full parallel V1 and V2 deployment.</p><pre><code class="language-mermaid">sequenceDiagram
    participant C as Client
    participant G as API Gateway
    participant S2 as Microservice V2
    participant S1 as Microservice V1

    C-&gt;&gt;G: Request V1 (GET /person/header, X-API-VERSION=1)
    alt Response Transformation for Non-Breaking Change
        Note over G: Route to latest version S2
        G-&gt;&gt;S2: Transform Request (if needed) &amp; Forward
        S2-&gt;&gt;G: Response V2 (with firstName, lastName)
        Note over G: Transform Response (concat to name) to V1 Schema
        G-&gt;&gt;C: Response V1 (with name)
    else Breaking Change
        Note over G: Route to appropriate version S1
        G-&gt;&gt;S1: Forward Request V1
        S1-&gt;&gt;G: Response V1
        G-&gt;&gt;C: Response V1
    end
</code></pre><hr/><h2 id="next-steps-and-improvements">üí°Next Steps and Improvements</h2><ul><li><strong>Documentation Tooling:</strong><ul><li>Integrate an API documentation tool like <strong>OpenAPI (Swagger)</strong>.</li><li>Ensure the documentation tool clearly shows how to access each version (via URI, header, or parameter).</li></ul></li><li><strong>Custom Annotations:</strong><ul><li>For cleaner controller code, consider creating a custom Spring annotation (e.g., <code class="language-plaintext highlighter-rouge">@ApiVersion(version = "1")</code>) that internally handles the different versioning strategies.</li></ul></li></ul><p><br/> This video provides a deep dive into implementing various API versioning strategies in Spring Boot. <a href="https://www.youtube.com/watch?v=ZA-MzWpKvtQ">API Versioning In Spring Framework 7 by Rossen Stoyanchev @ Spring I/O 2025</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div></div></main></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script><script src="/geekmonks/assets/js/mermaid-diagram-render.js?v=0.1.0"></script><script src="/geekmonks/assets/js/submenu-togle.js?v=0.1.0"></script></body></html>