<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="geekmonks, geek, tech, geekmonks tech, free tutorial, free online tutorial"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Geekmonks Tech"><meta name="mobile-web-app-capable" content="yes"><link rel="icon" type="image/png" href="/geekmonks/assets/favicon/favicon-96x96.png" sizes="96x96"/><link rel="icon" type="image/svg+xml" href="/geekmonks/assets/favicon/favicon.svg"/><link rel="shortcut icon" href="/geekmonks/assets/favicon/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/geekmonks/assets/favicon/apple-touch-icon.png"/><link rel="manifest" href="/geekmonks/assets/favicon/site.webmanifest"/><link type="application/atom+xml" rel="alternate" href="https://srvivek1.github.io/geekmonks/feed.xml" title="Geekmonks Tech"/><title>üõ°Ô∏è Client-Driven Filtering | Geekmonks Tech</title><meta name="generator" content="Jekyll v3.10.0"/><meta property="og:title" content="üõ°Ô∏è Client-Driven Filtering"/><meta property="og:locale" content="en_US"/><meta name="description" content="Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, path variables, request body, static content filtering, dynamic content filtering, Client driven filtering etc. for beginners and professionals."/><meta property="og:description" content="Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, path variables, request body, static content filtering, dynamic content filtering, Client driven filtering etc. for beginners and professionals."/><link rel="canonical" href="https://srvivek1.github.io/geekmonks/spring/spring-boot/client-driven-filtering.html"/><meta property="og:url" content="https://srvivek1.github.io/geekmonks/spring/spring-boot/client-driven-filtering.html"/><meta property="og:site_name" content="Geekmonks Tech"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2024-11-22T15:00:00+05:30"/><meta name="twitter:card" content="summary"/><meta property="twitter:title" content="üõ°Ô∏è Client-Driven Filtering"/><meta name="twitter:site" content="@srvivek_"/><script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-11-22T15:00:00+05:30","datePublished":"2024-11-22T15:00:00+05:30","description":"Geekmonks Tech - Spring Tutorial, Spring Boot Tutorial, Free Spring Boot tutorial, Free Online Tutorials, geekmonks provides tutorials and interview questions for Spring Boot, Spring, controllers, rest controllers, api, query param, path variables, request body, static content filtering, dynamic content filtering, Client driven filtering etc. for beginners and professionals.","headline":"üõ°Ô∏è Client-Driven Filtering","mainEntityOfPage":{"@type":"WebPage","@id":"https://srvivek1.github.io/geekmonks/spring/spring-boot/client-driven-filtering.html"},"url":"https://srvivek1.github.io/geekmonks/spring/spring-boot/client-driven-filtering.html"}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-48XEHMVSEC"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date);gtag("config","G-48XEHMVSEC");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"><link rel="stylesheet" href="/geekmonks/assets/css/styles.css?v=0.1.0"></head><body class="container-fluid p-0 m-0"><header><nav class="navbar navbar-expand-md navbar-light bg-light text-white content-shadow"><div class="container d-flex justify-content-between"><a href="/geekmonks/" class="navbar-brand d-flex"><img class="d-inline-block align-top" src="/geekmonks/assets/icons/laptop.svg" height="40" width="34" alt="banner-1 laptop icon"/><h1 class="fs-3 px-2 fw-bold">Geekmonks</h1><img class="d-inline-block align-top" src="/geekmonks/assets/icons/tux.svg" height="40" width="34" alt="banner-2 penguine icon"/></a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavBanner" aria-controls="navbarNavBanner" aria-expanded="false" aria-label="Toggle Navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarNavBanner" class="collapse navbar-collapse"><ul class="navbar-nav ms-auto"><li class="nav-item active"><a href="/geekmonks/" class="nav-link fw-bold active">Home</a></li><li class="nav-item active"><a href="/geekmonks/about" class="nav-link fw-bold active">About</a></li><li class="nav-item active"><a href="https://github.com/SRVivek1/" class="nav-link fw-bold active" target="_blank" rel="noopener noreferrer">Github</a></li><li class="nav-item active"><a href="https://www.linkedin.com/in/srvivek1/" class="nav-link fw-bold active" target="_blank" rel="noopener noreferrer">LinkedIn</a></li></ul></div></div></nav><nav class="navbar navbar-expand-xl navbar-custom p-0"><div class="container-fluid"><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav mx-auto"><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/ai-ml/llm-engineering/">AI-ML</a></li><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/cloud/aws/">AWS</a></li><li class="nav-item"><a class="nav-link fw-bold text-white" href="/geekmonks/spring/spring-boot/">Spring Boot</a></li></ul></div></div></nav></header><div class="container-fluid"><div class="row min-vh-100"><nav id="course-sidebar" class="col-md-3 col-lg-2 d-md-block sidebar collapse"><div class="position-sticky pt-3"><ul class="nav flex-column course-topics-list"><a class="nav-link course-link active" href="/geekmonks/spring/spring-boot" data-course="spring/spring-boot"> Spring Boot </a><ul class="nav flex-column ms-2 subtopics" id="topics-spring-spring-boot"><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="getting-started.html" data-topic="getting-started.html" data-course-path="/spring/spring-boot"> Getting Started </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="rest-api-validation.html" data-topic="rest-api-validation.html" data-course-path="/spring/spring-boot"> API Validation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="swagger-api-doc.html" data-topic="swagger-api-doc.html" data-course-path="/spring/spring-boot"> API Documentation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="content-negotiation.html" data-topic="content-negotiation.html" data-course-path="/spring/spring-boot"> Content Negotiation </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="i18n.html" data-topic="i18n.html" data-course-path="/spring/spring-boot"> Internationalization (i18n) </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="rest-api-versioning.html" data-topic="rest-api-versioning.html" data-course-path="/spring/spring-boot"> API Versioning </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="rest-api-retirement.html" data-topic="rest-api-retirement.html" data-course-path="/spring/spring-boot"> API Retirement Strategy </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="hateoas.html" data-topic="hateoas.html" data-course-path="/spring/spring-boot"> HATEOAS </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="static-content-filtering.html" data-topic="static-content-filtering.html" data-course-path="/spring/spring-boot"> Static Content Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="dynamic-content-filtering.html" data-topic="dynamic-content-filtering.html" data-course-path="/spring/spring-boot"> Dynamic Content Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small active" href="client-driven-filtering.html" data-topic="client-driven-filtering.html" data-course-path="/spring/spring-boot"> Client-Driven Filtering </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="exception-error-handling.html" data-topic="exception-error-handling.html" data-course-path="/spring/spring-boot"> Controller Error Handling </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="hal-explorer.html" data-topic="hal-explorer.html" data-course-path="/spring/spring-boot"> HAL Explorer </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="spring-data-jpa.html" data-topic="spring-data-jpa.html" data-course-path="/spring/spring-boot"> Spring Data JPA </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-with-h2-db.html" data-topic="jpa-with-h2-db.html" data-course-path="/spring/spring-boot"> JPA with H2 DB </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-with-mysql-db.html" data-topic="jpa-with-mysql-db.html" data-course-path="/spring/spring-boot"> JPA with MySQL DB </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="jpa-jdbc-template.html" data-topic="jpa-jdbc-template.html" data-course-path="/spring/spring-boot"> JPA & JDBC Teamplate </a></li><li class="nav-item" style="text-align: left"><a class="nav-link topic-link small " href="spring-security-basics.html" data-topic="spring-security-basics.html" data-course-path="/spring/spring-boot"> Spring Security </a></li></ul></ul></div></nav><main class="col-md-9 ms-sm-auto col-lg-10 px-md-4"><button id="sidebarToggle" class="btn btn-sm btn-outline-secondary d-md-none mb-2" aria-label="Toggle topics" aria-controls="course-sidebar"> ‚ò∞ Topics </button><div id="topic-content"><div id="pageTitle"><h1>üõ°Ô∏è Client-Driven Filtering</h1><p style="font-style: italic;"> Updated on: 22 Nov 2024 - <a href="/geekmonks/authors/srvivek/">Vivek Singh</a></p><hr class="stylish-hr"/></div><blockquote><p><strong>Note:</strong> This section discusses a technique for clients to request a <em>subset</em> of fields or related entities from an API response, enhancing performance and flexibility.</p></blockquote><h2 id="-table-of-contents">üìö Table of Contents</h2><ul><li><a href="#-table-of-contents">üìö Table of Contents</a></li><li><a href="#-introduction-to-client-driven-filtering">üåü Introduction to Client-Driven Filtering</a></li><li><a href="#-purpose-and-benefits">üéØ Purpose and Benefits</a></li><li><a href="#Ô∏è-implementation-aspects">‚öôÔ∏è Implementation Aspects</a><ul><li><a href="#field-filtering-partial-response">Field Filtering (Partial Response)</a><ul><li><a href="#code--config-spring-bootjackson">Code \&amp; Config (Spring Boot/Jackson)</a></li></ul></li><li><a href="#relationship-filtering-dynamic-eager-loading">Relationship Filtering (Dynamic Eager Loading)</a><ul><li><a href="#implementation-strategy-jpahibernate">Implementation Strategy (JPA/Hibernate)</a></li></ul></li></ul></li><li><a href="#-use-case-example">üí° Use Case Example</a></li><li><a href="#Ô∏è-suggested-improvement-for-api-design">üõ†Ô∏è Suggested Improvement for API Design</a><ul><li><a href="#simplified-architecture-diagram">Simplified Architecture Diagram</a></li></ul></li></ul><hr/><h2 id="-introduction-to-client-driven-filtering">üåü Introduction to Client-Driven Filtering</h2><p><strong>Client-Driven Filtering</strong> is an API design pattern where the <strong>client dictates</strong> what data (fields or related resources) they want to receive in the API response, typically via <strong>query parameters</strong>. Instead of the server always returning a full, potentially heavy, representation of a resource, the client asks for a <strong>partial response</strong>. This is crucial in microservices, especially when a single endpoint serves multiple clients with varying data needs, avoiding the classic <strong>Over-fetching</strong> problem.</p><hr/><h2 id="-purpose-and-benefits">üéØ Purpose and Benefits</h2><p>The primary <strong>purpose</strong> is to improve <strong>network efficiency</strong> and <strong>application performance</strong> by minimizing the payload size.</p><table><thead><tr><th style="text-align: left">üéØ Aspect</th><th style="text-align: left">Short Description</th><th style="text-align: left">Detailed Benefit</th></tr></thead><tbody><tr><td style="text-align: left"><strong>Primary Purpose</strong></td><td style="text-align: left">Improve <strong>Network Efficiency</strong> and <strong>Application Performance</strong></td><td style="text-align: left">Achieved by minimizing the overall data payload size transferred between client and server.</td></tr><tr><td style="text-align: left"><strong>Bandwidth Reduction</strong></td><td style="text-align: left">Decrease data transfer volume</td><td style="text-align: left">Especially beneficial for <strong>mobile clients</strong> or connections with <strong>high latency</strong> and limited bandwidth.</td></tr><tr><td style="text-align: left"><strong>Faster Response Time</strong></td><td style="text-align: left">Quicker processing on both ends</td><td style="text-align: left">Smaller payloads reduce the time required for <strong>serialization/deserialization</strong> processes on the server and client.</td></tr><tr><td style="text-align: left"><strong>Reduced Server Load</strong></td><td style="text-align: left">Lower resource utilization</td><td style="text-align: left">Less data to process in the application layer and potentially less strain on the database if filtering influences the data retrieval query.</td></tr><tr><td style="text-align: left"><strong>API Flexibility</strong></td><td style="text-align: left">Single, robust endpoint for diverse clients</td><td style="text-align: left">Allows a single endpoint to efficiently serve various client needs (e.g., list views requiring minimal fields, detail views requiring all fields).</td></tr></tbody></table><hr/><h2 id="Ô∏è-implementation-aspects">‚öôÔ∏è Implementation Aspects</h2><p>Implementing client-driven filtering in a <strong>Spring Boot</strong> application involves two main types: <strong>Field Filtering</strong> (partial response) and <strong>Relationship Filtering</strong> (dynamic eager loading).</p><h3 id="field-filtering-partial-response">Field Filtering (Partial Response)</h3><p>This involves selectively serializing fields in the DTO based on a client-provided list of desired fields (e.g., <code class="language-plaintext highlighter-rouge">?fields=id,name,price</code>).</p><h4 id="code--config-spring-bootjackson">Code &amp; Config (Spring Boot/Jackson)</h4><p>While custom logic is an option, using Spring Boot‚Äôs integration with <strong>Jackson</strong> library allows powerful dynamic filtering. Jackson‚Äôs <code class="language-plaintext highlighter-rouge">@JsonFilter</code> and <code class="language-plaintext highlighter-rouge">FilterProvider</code> can be used, although a simpler approach for partial response is often implemented using a custom <strong><code class="language-plaintext highlighter-rouge">MappingJacksonValue</code></strong>.</p><p><strong>Controller Example (Java):</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ser.FilterProvider</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ser.impl.SimpleBeanPropertyFilter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ser.impl.SimpleFilterProvider</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.converter.json.MappingJacksonValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductController</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/products/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">MappingJacksonValue</span> <span class="nf">getProductDetails</span><span class="o">(</span>
            <span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> 
            <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">fields</span><span class="o">)</span> <span class="o">{</span>
        
        <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productService</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span> <span class="c1">// Assume this fetches the Product DTO</span>

        <span class="c1">// 1. Create a MappingJacksonValue for dynamic filtering</span>
        <span class="nc">MappingJacksonValue</span> <span class="n">mapping</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MappingJacksonValue</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">fields</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">fields</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="c1">// 2. Define which properties to include</span>
            <span class="nc">String</span><span class="o">[]</span> <span class="n">fieldArray</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
            <span class="nc">SimpleBeanPropertyFilter</span> <span class="n">filter</span> <span class="o">=</span> 
                <span class="nc">SimpleBeanPropertyFilter</span><span class="o">.</span><span class="na">filterOutAllExcept</span><span class="o">(</span><span class="n">fieldArray</span><span class="o">);</span>
            
            <span class="c1">// 3. Register the filter with an arbitrary ID ("productFilter")</span>
            <span class="nc">FilterProvider</span> <span class="n">filters</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleFilterProvider</span><span class="o">()</span>
                <span class="o">.</span><span class="na">addFilter</span><span class="o">(</span><span class="s">"productFilter"</span><span class="o">,</span> <span class="n">filter</span><span class="o">);</span>
            
            <span class="c1">// 4. Apply the filter provider</span>
            <span class="n">mapping</span><span class="o">.</span><span class="na">setFilters</span><span class="o">(</span><span class="n">filters</span><span class="o">);</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">mapping</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p><br/></p><p><strong>DTO Example (Java):</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonFilter</span><span class="o">;</span>

<span class="c1">// The @JsonFilter annotation links the DTO to the filter ID ("productFilter")</span>
<span class="nd">@JsonFilter</span><span class="o">(</span><span class="s">"productFilter"</span><span class="o">)</span> 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductDTO</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">price</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">description</span><span class="o">;</span>
    <span class="c1">// Getters and Setters...</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="relationship-filtering-dynamic-eager-loading">Relationship Filtering (Dynamic Eager Loading)</h3><p>This allows the client to request related resources to be included (<strong>eagerly loaded</strong>) in the primary resource‚Äôs response (e.g., <code class="language-plaintext highlighter-rouge">?includes=category,reviews</code>). This is often implemented in the <strong>Service/Repository Layer</strong> by dynamically deciding which related entities to fetch from the database.</p><h4 id="implementation-strategy-jpahibernate">Implementation Strategy (JPA/Hibernate)</h4><p>With <strong>JPA (e.g., Hibernate)</strong>, this can be achieved by using <strong>Entity Graphs</strong> or dynamic <strong><code class="language-plaintext highlighter-rouge">JOIN FETCH</code></strong> clauses based on the <code class="language-plaintext highlighter-rouge">includes</code> parameter.</p><p><strong>Service Example (Java/JPA):</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">jakarta.persistence.EntityGraph</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.persistence.EntityManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">EntityManager</span> <span class="n">entityManager</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ProductService</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">entityManager</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">entityManager</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Product</span> <span class="nf">findProductWithIncludes</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">includes</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Basic example: Create a simple EntityGraph dynamically</span>
        <span class="nc">EntityGraph</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createEntityGraph</span><span class="o">(</span><span class="nc">Product</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">includes</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">includes</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"category"</span><span class="o">))</span> <span class="o">{</span>
             <span class="n">graph</span><span class="o">.</span><span class="na">addAttributeNodes</span><span class="o">(</span><span class="s">"category"</span><span class="o">);</span> <span class="c1">// Eagerly load 'category'</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">includes</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">includes</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"reviews"</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// Add sub-graphs or other logic for complex relationships</span>
             <span class="n">graph</span><span class="o">.</span><span class="na">addAttributeNodes</span><span class="o">(</span><span class="s">"reviews"</span><span class="o">);</span> 
        <span class="o">}</span>

        <span class="c1">// Fetch the entity using the dynamic EntityGraph</span>
        <span class="k">return</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Product</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">,</span> <span class="nc">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"jakarta.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">graph</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><blockquote><p><strong>Note:</strong> The above JPA example is simplified. In production, consider using QueryDSL or Specification to build dynamic <code class="language-plaintext highlighter-rouge">JOIN FETCH</code> queries for more complex scenarios.</p></blockquote><hr/><h2 id="-use-case-example">üí° Use Case Example</h2><table><thead><tr><th style="text-align: left">Client Type</th><th style="text-align: left">Request</th><th style="text-align: left">Description</th></tr></thead><tbody><tr><td style="text-align: left"><strong>Mobile List View</strong></td><td style="text-align: left"><code class="language-plaintext highlighter-rouge">/products?fields=id,name,price</code></td><td style="text-align: left">Needs minimal data for a scrolling list of products. <strong>Saves bandwidth</strong> by omitting descriptions, images, etc.</td></tr><tr><td style="text-align: left"><strong>Web Detail Page</strong></td><td style="text-align: left"><code class="language-plaintext highlighter-rouge">/products?fields=*,description&amp;includes=reviews,seller</code></td><td style="text-align: left">Needs all core fields (<code class="language-plaintext highlighter-rouge">*</code>) plus <code class="language-plaintext highlighter-rouge">description</code>, and requires <strong>related entities</strong> like <code class="language-plaintext highlighter-rouge">reviews</code> and <code class="language-plaintext highlighter-rouge">seller</code> details in a single call.</td></tr><tr><td style="text-align: left"><strong>Internal Service</strong></td><td style="text-align: left"><code class="language-plaintext highlighter-rouge">/products?fields=id,internalSku</code></td><td style="text-align: left">An inventory service only needs identifiers for its processing, filtering out public-facing data.</td></tr></tbody></table><hr/><h2 id="Ô∏è-suggested-improvement-for-api-design">üõ†Ô∏è Suggested Improvement for API Design</h2><p>For maximum clarity and adoption, I suggest adopting a standard, well-documented approach like the <strong>GraphQL</strong> data-fetching model or adhering to the <strong>JSON:API</strong> standard for complex relationship inclusion/exclusion.</p><p><strong>Adoption of a Standard:</strong></p><ul><li><strong>GraphQL:</strong> Completely eliminates over-fetching by design, allowing the client to specify the exact shape of the response in the query itself.</li><li><strong>Recommendation:</strong> If performance and flexible data retrieval is a core requirement across many microservices, <strong>consider migrating key read operations to a GraphQL layer</strong> (e.g., a <em>Gateway</em> or <em>BFF - Backend For Frontend</em>) that aggregates data from your underlying Spring Boot microservices.</li></ul><p><br/></p><p><strong>Visualizing the Impact:</strong></p><h3 id="simplified-architecture-diagram">Simplified Architecture Diagram</h3><p>Here‚Äôs how <strong>Client-Driven Filtering</strong> fits into a typical request flow:</p><pre><code class="language-mermaid">sequenceDiagram
    participant C as Client
    participant SB as Spring Boot API
    participant DB as Database (JPA)

    C-&gt;&gt;SB: GET /products/1?fields=name,price&amp;includes=category
    activate SB
    SB--&gt;&gt;DB: Dynamic Query (e.g., SELECT name, price, category details)
    activate DB
    DB--&gt;&gt;SB: Full Entity/DTO with Eager Loaded Category
    deactivate DB
    SB-&gt;&gt;SB: Serialization (Jackson applies 'fields' filter)
    SB--&gt;&gt;C: Response (JSON with only name, price, and category)
    deactivate SB
</code></pre><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div></div></main></div></div><div><footer class="row row-cols-1 row-cols-sm-2 row-cols-md-5 py-4 mx-5 my-5 border-top"><div class="col-md-4 d-flex align-items-center"><a href="/geekmonks/" class="mb-3 me-2 mb-md-0 text-body-secondary text-decoration-none lh-1" aria-label="Geekmonks"><svg class="bi me-2" width="40" height="32" aria-hidden="true" viewBox="0 0 200 200"><defs><linearGradient id="gradient" gradientTransform="rotate(145 0.5 0.5)"><stop offset="0%" stop-color="#f7e625"></stop><stop offset="100%" stop-color="#e6a62c"></stop></linearGradient></defs><rect width="200" height="200" fill="url('#gradient')"></rect><g fill="#303e37" transform="matrix(12.312625250501002,0,0,12.312625250501002,16.825404661093543,187.54701945968048)" stroke="#3b8349" stroke-width="0.2"><path d="M12.71-7.60L12.71-1.76Q11.92-0.88 10.40-0.34Q8.88 0.20 7.06 0.20L7.06 0.20Q4.27 0.20 2.60-1.51Q0.93-3.22 0.81-6.27L0.81-6.27L0.80-7.50Q0.80-9.60 1.54-11.17Q2.29-12.73 3.67-13.58Q5.05-14.42 6.87-14.42L6.87-14.42Q9.52-14.42 10.99-13.21Q12.46-11.99 12.71-9.58L12.71-9.58L9.40-9.58Q9.23-10.77 8.64-11.28Q8.06-11.79 6.98-11.79L6.98-11.79Q5.69-11.79 4.99-10.69Q4.29-9.60 4.28-7.57L4.28-7.57L4.28-6.71Q4.28-4.58 5.00-3.51Q5.73-2.44 7.29-2.44L7.29-2.44Q8.63-2.44 9.29-3.04L9.29-3.04L9.29-5.24L6.90-5.24L6.90-7.60L12.71-7.60Z"></path></g></svg></a><span class="mb-3 mb-md-0 text-body-secondary">¬© 2025 Company, Inc</span></div><div class="col mb-3"></div><div class="col mb-3"><h5>Company</h5><ul class="nav col-md-4"><li class="nav-item"><a href="/geekmonks/" class="nav-link px-2 text-body-secondary">Home</a></li><li class="nav-item"><a href="/geekmonks/about" class="nav-link px-2 text-body-secondary">About</a></li><li class="nav-item"><a href="https://github.com/SRVivek1/" target="_blank" class="nav-link px-2 text-body-secondary">Github</a></li><li class="nav-item"><a href="https://www.linkedin.com/in/srvivek1/" target="_blank" class="nav-link px-2 text-body-secondary">LinkedIn</a></li></ul></div><div class="col mb-3"><h5>Tutorials</h5><ul class="nav flex-column"><li class="nav-item mb-2"><a href="/geekmonks/spring/spring-boot" class="nav-link p-0 text-body-secondary">Spring Boot</a></li><li class="nav-item mb-2"><a href="/geekmonks/ai-ml/llm-engineering" class="nav-link p-0 text-body-secondary">AI / ML</a></li><li class="nav-item mb-2"><a href="/geekmonks/cloud/aws" class="nav-link p-0 text-body-secondary">AWS</a></li></ul></div></footer></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script><script src="/geekmonks/assets/js/mermaid-diagram-render.js?v=0.1.0"></script><script src="/geekmonks/assets/js/submenu-togle.js?v=0.1.0"></script></body></html>