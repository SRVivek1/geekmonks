<h1>Property, method param or Return type validation</h1>

<p>
  Updated on: 
  
  
  
    - <a href="/geekmonks/authors/srvivek/">Vivek Singh</a>
  
</p>

<hr/>

<h3 id="project-ref-a3-sboot-ms-validation">Project ref: <a href="https://github.com/SRVivek1/springboot-microservices-2024/tree/main/a3-sboot-ms-validation">a3-sboot-ms-validation</a></h3>
<ul>
  <li><strong><ins>Maven / External dependency</ins></strong>
    <ul>
      <li>Add spring validation dependency.
 	```xml
	<dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency></li>
    </ul>
  </li>
  <li><strong><ins>Code changes</ins></strong>
    <ul>
      <li>imports
        <ul>
          <li><code class="language-plaintext highlighter-rouge">import jakarta.validation.Valid;</code></li>
        </ul>
      </li>
      <li>Annotate the method parameter for validation.
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/users"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">createUser</span><span class="o">(</span><span class="nd">@Valid</span> <span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"User to save : {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>

        <span class="kt">var</span> <span class="n">savedUser</span> <span class="o">=</span> <span class="n">userDaoService</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

        <span class="kt">var</span> <span class="n">location</span> <span class="o">=</span> <span class="nc">ServletUriComponentsBuilder</span><span class="o">.</span><span class="na">fromCurrentRequest</span><span class="o">().</span><span class="na">path</span><span class="o">(</span><span class="s">"{id}"</span><span class="o">).</span><span class="na">buildAndExpand</span><span class="o">(</span><span class="n">savedUser</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span>
                <span class="o">.</span><span class="na">toUri</span><span class="o">();</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">created</span><span class="o">(</span><span class="n">location</span><span class="o">).</span><span class="na">body</span><span class="o">(</span><span class="n">savedUser</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li>imports
        <ul>
          <li><code class="language-plaintext highlighter-rouge">import jakarta.validation.constraints.Past;</code></li>
          <li><code class="language-plaintext highlighter-rouge">import jakarta.validation.constraints.Size;</code></li>
        </ul>
      </li>
      <li>Add validation in the properties of the bean.
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">id</span><span class="o">;</span>

        <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">3</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"Name must be more than 2 characters."</span><span class="o">)</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

        <span class="nd">@Past</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Birth date should be in past."</span><span class="o">)</span>
        <span class="nd">@JsonFormat</span><span class="o">(</span><span class="n">shape</span> <span class="o">=</span> <span class="nc">JsonFormat</span><span class="o">.</span><span class="na">Shape</span><span class="o">.</span><span class="na">STRING</span><span class="o">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">"yyyy-MM-dd"</span><span class="o">)</span>
        <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">birthDate</span><span class="o">;</span>

        <span class="c1">// constructors, setter-getters and other methods.</span>
    <span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li><strong><ins>Notes:</ins></strong>
        <ul>
          <li>Spring internally usages <code class="language-plaintext highlighter-rouge">jakarta-validation</code> API.</li>
          <li>Check <code class="language-plaintext highlighter-rouge">jakarta.validation.constraints.*</code> for more validation classes.
            <ul>
              <li><code class="language-plaintext highlighter-rouge">@Valid</code> annotation:
                <ul>
                  <li>Marks a property, method parameter or method return type for validation cascading.</li>
                  <li>Constraints defined on the object and its properties are validated when the property, method parameter or method return type is validated.</li>
                </ul>
              </li>
              <li><code class="language-plaintext highlighter-rouge">@Size</code> annotation
                <ul>
                  <li>Validates property value to match defined size constraints.</li>
                </ul>
              </li>
              <li><code class="language-plaintext highlighter-rouge">@Past</code> annotation
                <ul>
                  <li>Validates date value for must be a past date.</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


<!-- TODO: add footer -->